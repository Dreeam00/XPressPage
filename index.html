<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XPress Page</title>
    <link rel="icon" href="icon.png" type="image/png">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app-header">
        <div id="office-button">
            <img src="icon.png" alt="Office Button">
        </div>
        <div style="font-size: 18px; color: #1E4E8A; font-weight: bold; margin-left: 10px;">XPress Page</div>
        <button id="toggle-clippy-button" class="app-header-button" style="margin-left: auto;">Clippy表示/非表示</button>
    </div>

    <!-- Office Menu -->
    <div id="office-menu" style="display: none;">
        <div class="office-menu-item" id="menu-new">
            <img src="icon.png" alt="New">
            <span>新規作成</span>
            <small>新しい白紙のページを作成します。</small>
        </div>
        <div class="office-menu-item" id="menu-open">
            <img src="icon.png" alt="Open">
            <span>ファイルを開く</span>
            <small>HTMLファイルを読み込みます。</small>
        </div>
        <div class="office-menu-item" id="menu-save">
            <img src="save.png" alt="Save">
            <span>名前を付けて保存</span>
            <small>ページをHTMLファイルとして保存します。</small>
        </div>
    </div>
    <div id="ribbon-container">
        <div id="ribbon-tabs">
            <div class="ribbon-tab active" onclick="switchRibbonTab('home')">Home</div>
            <div class="ribbon-tab" onclick="switchRibbonTab('insert')">Insert</div>
            <div class="ribbon-tab" onclick="switchRibbonTab('view')">View</div>
        </div>
        <div id="ribbon-panes">
            <div class="ribbon-pane active" id="ribbon-home">
                <div class="ribbon-group">
                    <span class="group-title">Clipboard</span>
                    <button id="ribbon-paste"><img src="icons/ribon/icon_paste.png" alt="Paste"></button>
                    <button id="ribbon-cut"><img src="icons/ribon/icon_cut.png" alt="Cut"></button>
                    <button id="ribbon-copy"><img src="icons/ribon/icon_copy.png" alt="Copy"></button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Font</span>
                    <button id="toggle-bold"><img src="icons/ribon/icon_bold.png" alt="Bold"></button>
                    <button id="toggle-italic"><img src="icons/ribon/icon_italic.png" alt="Italic"></button>
                    <button id="toggle-underline"><img src="icons/ribon/icon_underline.png" alt="Underline"></button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Editing</span>
                    <button id="insert-into">Insert Into</button>
                    <button id="delete-element">Delete</button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Component</span>
                    <button id="save-component">Save Component</button>
                </div>
            </div>
            <div class="ribbon-pane" id="ribbon-insert">
                <div class="ribbon-group">
                    <span class="group-title">Containers</span>
                    <button id="insert-div">Div</button>
                    <button id="insert-span">Span</button>
                    <button id="insert-header">Header</button>
                    <button id="insert-hr">HR</button>
                    <button id="insert-template">Templates</button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Text</span>
                    <button id="insert-p"><img src="icons/ribon/icon_p.png" alt="Paragraph"></button>
                    <button id="insert-h1"><img src="icons/ribon/icon_h1.png" alt="H1"></button>
                    <button id="insert-h2">H2</button>
                    <button id="insert-h3">H3</button>
                    <button id="insert-a"><img src="icons/ribon/icon_link.png" alt="Link"></button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Media</span>
                    <button id="insert-img"><img src="icons/ribon/icon_img.png" alt="Image"></button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Lists</span>
                    <button id="insert-ul">UL</button>
                    <button id="insert-ol">OL</button>
                    <button id="insert-li">LI</button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Input</span>
                    <button id="insert-input"><img src="icons/ribon/icon_input.png" alt="Input"></button>
                    <button id="insert-textarea">Textarea</button>
                    <button id="insert-select">Select</button>
                </div>
                <div class="ribbon-group">
                    <span class="group-title">Table</span>
                    <button id="insert-table"><img src="icons/ribon/icon_table.png" alt="Table"></button>
                    <button id="insert-tr">TR</button>
                    <button id="insert-td">TD</button>
                    <button id="insert-th">TH</button>
                </div>
            </div>
            <div class="ribbon-pane" id="ribbon-view">
                 <div class="ribbon-group">
                    <span class="group-title">Panes</span>
                    <button>Toggle Left</button>
                    <button>Toggle Right</button>
                </div>
            </div>
        </div>
    </div>

    <div id="main-container">
        <div id="left-pane">
            <div class="pane-header">
                Component Tree
                <button id="move-up" class="app-header-button" style="float: right; margin-left: 5px;">▲</button>
                <button id="move-down" class="app-header-button" style="float: right;">▼</button>
            </div>
            <ul id="component-tree"></ul>
        </div>
        <div id="center-pane">
            <div id="editor-tabs">
                <div class="tab active" onclick="switchView('design')">Design</div>
                <div class="tab" onclick="switchView('split')">Split</div>
                <div class="tab" onclick="switchView('code')">Code</div>
            </div>
            <div id="editor-area">
                <div id="design-view" class="view active"><iframe id="wysiwyg-editor"></iframe></div>
                <div id="split-view" class="view">
                    <div id="split-design-pane"><iframe id="wysiwyg-editor-split"></iframe></div>
                    <div id="split-code-pane"><textarea id="code-editor-split"></textarea></div>
                </div>
                <div id="code-view" class="view"><textarea id="code-editor-full"></textarea></div>
            </div>
        </div>
        <div id="right-pane">
            <div class="pane-header">Properties</div>
            <div id="properties-panel"></div>
        </div>
    </div>
    <!-- Custom Element Insertion Dialog -->
    <div id="insert-dialog-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000;">
        <div id="insert-dialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #EAF2FB; border: 1px solid #95B3D8; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 20px; width: 300px; font-family: 'Segoe UI', Calibri, Arial, sans-serif; font-size: 12px;">
            <h3 style="margin-top: 0; color: #1E4E8A;">Insert Element</h3>
            <div style="margin-bottom: 15px;">
                <label for="dialog-element-type" style="display: block; margin-bottom: 5px; color: #333;">Select element type:</label>
                <select id="dialog-element-type" style="width: 100%; padding: 5px; border: 1px solid #ABC7EC; border-radius: 3px;">
                    <option value="div">Div</option>
                    <option value="p">Paragraph</option>
                    <option value="h1">Heading 1</option>
                    <option value="h2">Heading 2</option>
                    <option value="h3">Heading 3</option>
                    <option value="span">Span</option>
                    <option value="img">Image</option>
                    <option value="ul">Unordered List</option>
                    <option value="ol">Ordered List</option>
                    <option value="li">List Item</option>
                    <option value="a">Link</option>
                    <option value="input">Input</option>
                    <option value="textarea">Textarea</option>
                    <option value="table">Table</option>
                    <option value="tr">Table Row</option>
                    <option value="td">Table Data</option>
                    <option value="th">Table Header</option>
                </select>
            </div>
            <div style="text-align: right;">
                <button id="dialog-insert-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">Insert</button>
                <button id="dialog-cancel-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Template Selection Dialog -->
    <div id="template-dialog-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000;">
        <dialog id="template-dialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #EAF2FB; border: 1px solid #95B3D8; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 20px; width: 600px; max-height: 80%; overflow-y: auto; font-family: 'Segoe UI', Calibri, Arial, sans-serif; font-size: 12px;">
            <h3 style="margin-top: 0; color: #1E4E8A;">テンプレートを選択</h3>
            <select id="template-select" style="width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ABC7EC; border-radius: 3px;"></select>
            <div id="template-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                <!-- Templates will be dynamically loaded here -->
            </div>
            <div style="text-align: right; margin-top: 20px;">
                <button id="template-save-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">保存</button>
                <button id="template-delete-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">削除</button>
                <button id="template-cancel-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A;">キャンセル</button>
            </div>
        </dialog>
    </div>

    <!-- Custom Attribute Dialog -->
    <div id="attribute-dialog-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1001;">
        <div id="attribute-dialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #EAF2FB; border: 1px solid #95B3D8; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 20px; width: 350px; font-family: 'Segoe UI', Calibri, Arial, sans-serif; font-size: 12px;">
            <h3 id="attribute-dialog-title" style="margin-top: 0; color: #1E4E8A;"><img id="attribute-icon" class="custom-dialog-icon" src="icons/dialog/prompt.png">Configure Element Attributes</h3>
            <div id="attribute-fields">
                <!-- Attribute fields will be dynamically inserted here -->
            </div>
            <div style="text-align: right; margin-top: 15px;">
                <button id="attribute-insert-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">Insert</button>
                <button id="attribute-cancel-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Custom Alert Dialog -->
    <div id="alert-dialog-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1002;">
        <div id="alert-dialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #EAF2FB; border: 1px solid #95B3D8; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 20px; width: 300px; font-family: 'Segoe UI', Calibri, Arial, sans-serif; font-size: 12px;">
            <h3 style="margin-top: 0; color: #1E4E8A;"><img id="alert-icon" class="custom-dialog-icon" src="icons/dialog/error.png">Alert</h3>
            <p id="alert-message" style="margin-bottom: 15px; color: #333;"></p>
            <div style="text-align: right;">
                <button id="alert-ok-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">OK</button>
            </div>
        </div>
    </div>

    <!-- Custom Prompt Dialog -->
    <div id="prompt-dialog-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1003;">
        <div id="prompt-dialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #EAF2FB; border: 1px solid #95B3D8; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 20px; width: 300px; font-family: 'Segoe UI', Calibri, Arial, sans-serif; font-size: 12px;">
            <h3 style="margin-top: 0; color: #1E4E8A;"><img id="prompt-icon" class="custom-dialog-icon" src="icons/dialog/prompt.png">Input Required</h3>
            <p id="prompt-message" style="margin-bottom: 10px; color: #333;"></p>
            <input type="text" id="prompt-input" style="width: calc(100% - 10px); padding: 5px; border: 1px solid #ABC7EC; border-radius: 3px; background-color: #FFF; margin-bottom: 15px;">
            <div style="text-align: right;">
                <button id="prompt-ok-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">OK</button>
                <button id="prompt-cancel-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Dialog -->
    <div id="confirm-dialog-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1004;">
        <div id="confirm-dialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #EAF2FB; border: 1px solid #95B3D8; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 20px; width: 300px; font-family: 'Segoe UI', Calibri, Arial, sans-serif; font-size: 12px;">
            <h3 style="margin-top: 0; color: #1E4E8A;"><img id="confirm-icon" class="custom-dialog-icon" src="icons/dialog/warning.png">Confirm</h3>
            <p id="confirm-message" style="margin-bottom: 15px; color: #333;"></p>
            <div style="text-align: right;">
                <button id="confirm-ok-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">OK</button>
                <button id="confirm-cancel-btn" style="background: linear-gradient(to bottom, #EAF2FB, #D9E5F3); border: 1px solid #95B3D8; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; color: #1E4E8A; margin-left: 10px;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Clippy Assistant -->
    <div id="clippy-assistant">
        <img src="clippy.png" alt="Clippy Assistant" style="width: 80px; height: auto;">
        <div id="clippy-speech-bubble">
            <p id="clippy-hint-text">何かお手伝いできることはありますか？</p>
            <div style="display: flex; justify-content: space-around; margin-top: 8px;">
                <button id="clippy-trivia-button" class="clippy-button" style="flex-grow: 1; margin-right: 5px;">豆知識</button>
                <button id="clippy-general-hint-button" class="clippy-button" style="flex-grow: 1; margin-left: 5px;">ヒント</button>
            </div>
            <div id="clippy-trivia-display" class="clippy-trivia-display hidden"></div>
            <div id="clippy-general-hint-display" class="clippy-general-hint-display hidden"></div>
            <div class="speech-bubble-arrow-border"></div>
            <div class="speech-bubble-arrow-fill"></div>
        </div>
    </div>


    <!-- Status Bar -->
    <div id="status-bar">
        <div id="status-panel-main">準備完了</div>
        <div id="status-panel-right">Design View</div>
    </div>

    <script src="js/templates.js"></script>
    <script src="js/main.js"></script>
    <input type="file" id="file-input" accept=".html" style="display: none;">
</body>
</html>